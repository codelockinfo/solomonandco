  {%- liquid
          assign se_stts = block.settings
          assign layout = se_stts.layout
          assign image = se_stts.image
          assign use_pagination = se_stts.use_pagination 
          assign sett_equal = se_stts.use_eq_height
          assign show_vendor = se_stts.show_vendor
          assign col = se_stts.col_pr
          assign col_tb = se_stts.col_pr_tb
          assign col_mb = ' pr_animated done' | prepend:se_stts.col_pr_mb
          assign inc_pr = se_stts.pr_des
          assign limit = se_stts.limit
          assign use_cdt = se_stts.use_cdt
          assign txt_cd = 'products.grid_items.offer_end_in' | t
          assign sid = block.id
          if layout == 'wrap'
          assign html_layout = '<div class="container">__</div>' | split:'__'
          else
          assign html_layout = '__' | split:'__'
          endif -%}

        <div class="complementary_product ">

          {% if collection.metafields.custom.matchingcollection != blank %}
            {% if block.settings.complementarycollectionheading  %}
              <h4 class="complementary_title">{{ settings.settings.complementarycollectionheading }}</h4>
            {% endif %}
          
          
              {%- capture url_cat -%}{% if collection %}/collections/{{collection.handle}}{% endif %}{%- endcapture -%}
              {%- assign inc_price = settings.price_format -%}
              {%- assign use_rating = settings.use_pr_rating -%}
              {%- assign inc_rating = settings.app_review -%}
              {%- assign show_color = settings.show_pr_color -%}
              {%- assign show_cl_type = settings.show_color_type -%}
              {%- assign show_size = settings.show_pr_size -%}
            
              <div class="products nt_products_holder row row_pr_{{inc_pr}} cdt_des_{{se_stts.cdt_des}} round_cd_{{se_stts.round_cd}} {{se_stts.image_size}} {{se_stts.image_ratio}} position_{{se_stts.image_position}} space_{{se_stts.space}} prev_next_{{se_stts.btn_color}} btn_owl_{{se_stts.btn_owl}} dot_owl_{{se_stts.dot_owl}} dot_color_{{se_stts.dot_color}} btn_vi_{{se_stts.btn_vi}}{% if sett_equal %} equal_nt{% endif %}" data-flickity='{"imagesLoaded": 0,"adaptiveHeight": 0, "contain": 1, "groupCells": "100%", "dragThreshold" : 5, "cellAlign": "left","wrapAround": {{se_stts.loop}},"prevNextButtons": {{se_stts.button}},"percentPosition": 1,"pageDots": {{se_stts.dot}}, "autoPlay" : {{ se_stts.au_time | times: 1000 }}, "pauseAutoPlayOnHover" : {{se_stts.au_hover}}, "rightToLeft": {{settings.use_rtl}} }'>
                  {%- for collection_handle in collection.metafields.custom.matchingcollection.value -%}
                      {%- render 'collection_grid_item',collection:collection_handle,use_cdt:use_cdt,txt_cd:txt_cd, col:col, col_tb:col_tb, col_mb:col_mb,url_cat:url_cat,sett_equal:sett_equal,show_vendor:show_vendor,inc_price:inc_price,use_rating:use_rating,inc_rating:inc_rating,show_color:show_color,show_cl_type:show_cl_type,show_size:show_size -%}
                  {%- endfor -%}
              </div>
          {% endif %}
        </div>
      {%- comment -%}
        {%- when 'metafield' -%}
          {%- if pr_metafields_meta.option -%}{%- continue -%}{%- endif -%}
          <div class="meta_{{block.id}}">{{pr_metafields_meta.option}}</div>
      {%- endcomment -%}
 
{%- if call_cl == '_qv' -%}
  <a href="{{product.url | within: collection}}" class="btn fwsb detail_link">
    {{- 'products.product.product_view_details' | t }}
    <i class="facl facl-right"></i
  ></a>
{%- endif -%}